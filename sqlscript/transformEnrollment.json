{
	"name": "transformEnrollment",
	"properties": {
		"folder": {
			"name": "Tables"
		},
		"content": {
			"query": "drop table transform.Enrollment;\n\n\nSELECT [SchoolYear]\n      ,[OrganizationLevel]\n      ,[County]\n      ,[ESDName]\n      ,[ESDOrganizationID]\n      ,[DistrictCode]\n      ,[DistrictName]\n      ,[DistrictOrganizationId]\n      ,[SchoolCode]\n      ,[SchoolOrganizationid]\n      ,[CurrentSchoolType]\n      ,[GradeLevel]\n      ,d.[StudentGroup]\n      ,StudentGroupCategory\n      ,StudentGroupType\n      ,Enrollment\n--Into transform.Enrollment\nFROM (\n    SELECT [SchoolYear]\n          ,[OrganizationLevel]\n          ,[County]\n          ,[ESDName]\n          ,[ESDOrganizationID]\n          ,COALESCE(c.[Local District Code], a.[DistrictCode]) AS [DistrictCode]\n\t\t  ,COALESCE(c.[Local District], a.[DistrictName]) AS [DistrictName]\n          ,[DistrictOrganizationId]\n          ,[SchoolCode]\n\t\t  ,COALESCE([School Name], [SchoolName]) AS [SchoolName]\n          ,[SchoolOrganizationid]\n          ,[CurrentSchoolType]\n\t\t  ,b.[GradeLevel] as [GradeLevel]\n          ,[All Students]\n          ,[Female]\n          ,[Male]\n          ,[Gender X]\n          ,[American Indian/ Alaskan Native]\n          ,[Asian]\n          ,[Black/ African American]\n          ,[Hispanic/ Latino of any race(s)]\n          ,[Native Hawaiian/ Other Pacific Islander]\n          ,[Two or More Races]\n          ,[White]\n          ,[English Language Learners]\n          ,[Highly Capable]\n          ,[Homeless]\n          ,[Low-Income]\n          ,[Migrant]\n          ,[Military Parent]\n          ,[Mobile]\n          ,[Section 504]\n          ,[Students with Disabilities]\n    FROM [staging].[Enrollment] a\n\tLEFT JOIN dim.GradeLevel b ON a.GradeLevel = b.GradeLevelKey\n\tLEFT JOIN staging.CharterSchoolDirectory c ON a.SchoolCode = c.[School Code]\n) AS src\nUNPIVOT (\n    Enrollment FOR StudentGroup IN (\n        [All Students]\n        ,[Female]\n        ,[Male]\n        ,[Gender X]\n        ,[American Indian/ Alaskan Native]\n        ,[Asian]\n        ,[Black/ African American]\n        ,[Hispanic/ Latino of any race(s)]\n        ,[Native Hawaiian/ Other Pacific Islander]\n        ,[Two or More Races]\n        ,[White]\n        ,[English Language Learners]\n        ,[Highly Capable]\n        ,[Homeless]\n        ,[Low-Income]\n        ,[Migrant]\n        ,[Military Parent]\n        ,[Mobile]\n        ,[Section 504]\n        ,[Students with Disabilities]\n    )\n) AS unpvt\nleft join [dim].[StudentGroup] d on unpvt.StudentGroup = d.StudentGroup\nWHERE d.StudentGroup NOT LIKE 'Non%'",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}