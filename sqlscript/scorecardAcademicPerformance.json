{
	"name": "scorecardAcademicPerformance",
	"properties": {
		"folder": {
			"name": "Tables"
		},
		"content": {
			"query": "-- scorecard.AcademicPerformance\n\n--Drop TABLE scorecard.AcademicPerformance; \n\nwith cte_school as (\nSELECT    SchoolYear,\n    OrganizationLevel,\n    County,\n    ESDName,\n    ESDOrganizationID,\n    DistrictOrganizationId,\n    SchoolCode,\n    SchoolOrganizationid,\n    CurrentSchoolType,\n    StudentGroupType,\n    StudentGroup,\n    GradeLevel,\n    TestAdministration,\n    TestSubject,\n    Suppression,\n    Cast([Count of Students Expected to Test] as int) as [Count of Students Expected to Test],\n    cast([CountMetStandard]as int) as[CountMetStandard],\n    cast( [CountofStudentsExpectedtoTest(including previously passed)] as int) as [CountofStudentsExpectedtoTest(including previously passed)],\n    [PercentMetStandard],\n    DataAsOf,\n    SchoolName,\n    DistrictCode,\n    DistrictName,\n\tcast([CountMetStandard] as float)/cast([CountofStudentsExpectedtoTest(including previously passed)] as float) as [PercentMetSchool]\nFROM transform.AcademicPerformance \nWHERE OrganizationLevel = 'School'\n\n),\ncte_District as (\nSELECT  [SchoolYear]\n      ,[GradeLevel]\n      ,[TestAdministration]\n      ,[TestSubject]\n\t  ,[StudentGroup]\n\t  ,[DistrictCode]\n      ,[DistrictName]\n      ,Cast([Count of Students Expected to Test] as int) as [Count of Students Expected to Test]\n      ,cast([CountMetStandard]as int) as[CountMetStandard]\n      ,cast( [CountofStudentsExpectedtoTest(including previously passed)] as int) as [CountofStudentsExpectedtoTest(including previously passed)]\n      ,[PercentMetStandard]\n\t  ,cast([CountMetStandard] as float)/cast([CountofStudentsExpectedtoTest(including previously passed)] as float) as [PercentMetDistrict]\nFROM transform.AcademicPerformance \nWHERE OrganizationLevel = 'District'\n)\n\n\nSELECT a.[SchoolYear]\n      ,[OrganizationLevel]\n      ,[County]\n      ,[ESDName]\n      ,[ESDOrganizationID]\n      ,[DistrictOrganizationId]\n      ,[SchoolCode]\n      ,[SchoolOrganizationid]\n      ,[CurrentSchoolType]\n      ,[StudentGroupType]\n      ,a.[StudentGroup]\n      ,a.[GradeLevel]\n      ,a.[TestAdministration]\n      ,a.[TestSubject]\n      ,[Suppression]\n      ,a.[Count of Students Expected to Test]\n      ,a.[CountMetStandard]\n      ,a.[CountofStudentsExpectedtoTest(including previously passed)]\n      ,a.[PercentMetStandard]\n\t  ,[PercentMetSchool]\n\t  ,b.[Count of Students Expected to Test]\n      ,b.[CountMetStandard]\n      ,b.[CountofStudentsExpectedtoTest(including previously passed)]\n      ,b.[PercentMetStandard]\n\t  ,[PercentMetDistrict]\n      ,[DataAsOf]\n      ,[SchoolName]\n      ,b.[DistrictCode]\n      ,b.[DistrictName]\n--Into scorecard.AcademicPerformance\nFROM cte_school a\nJOIN cte_District b ON a.DistrictCode = b.DistrictCode AND a.SchoolYear = b.SchoolYear \n\tand a.StudentGroup = b.StudentGroup and a.GradeLevel= b.GradeLevel and a.TestAdministration = b.TestAdministration\n\tand a.TestSubject = b.TestSubject\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}