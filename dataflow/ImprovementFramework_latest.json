{
	"name": "ImprovementFramework_latest",
	"properties": {
		"folder": {
			"name": "Improvment Framework"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ImprovementFramework2023",
						"type": "DatasetReference"
					},
					"name": "source3"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "select4"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ESD_Organization_Id as string,",
				"          ESD_Name as string,",
				"          District_Organization_Id as string,",
				"          District_Code as string,",
				"          District_Name as string,",
				"          School_Code as string,",
				"          School_Name as string,",
				"          School_Organization_Id as string,",
				"          School_Type as string,",
				"          {2023_TitleI} as string,",
				"          Student_Group as string,",
				"          Proficiency_ELA_Numerator as string,",
				"          Proficiency_ELA_Denominator as string,",
				"          Proficiency_ELA_Rate as string,",
				"          Proficiency_ELA_Decile as string,",
				"          ELA_MetESSA_Participation as string,",
				"          Proficiency_Math_Numerator as string,",
				"          Proficiency_Math_Denominator as string,",
				"          Proficiency_Math_Rate as string,",
				"          Proficiency_Math_Decile as string,",
				"          Math_MetESSA_Participation as string,",
				"          Proficiency_Combined_Decile as string,",
				"          Growth_ELA_NumberofStudents as string,",
				"          Growth_ELA_Median_SGP as string,",
				"          Growth_ELA_Decile as string,",
				"          Growth_Math_NumberofStudents as string,",
				"          Growth_Math_Median_SGP as string,",
				"          Growth_Math_Decile as string,",
				"          Other_Academic_Combined_Decile as string,",
				"          Grad_FourYear_Numerator as string,",
				"          Grad_FourYear_Denominator as string,",
				"          Grad_FourYear_Rate as string,",
				"          Grad_FourYear_Decile as string,",
				"          Grad_Extended_TotalIncrease as string,",
				"          Grad_Extended_DecileIncrease as string,",
				"          Grad_Combined_Decile as string,",
				"          EL_Progress_Numerator as string,",
				"          EL_Progress_Denominator as string,",
				"          EL_Progress_Rate as string,",
				"          EL_Progress_Decile as string,",
				"          RegularAttendance_Numerator as string,",
				"          RegularAttendance_Denominator as string,",
				"          RegularAttendance_Rate as string,",
				"          RegularAttendance_Decile as string,",
				"          NinthGradeOnTrack_Numerator as string,",
				"          NinthGradeOnTrack_Denominator as string,",
				"          NinthGradeOnTrack_Rate as string,",
				"          NinthGradeOnTrack_Decile as string,",
				"          DualCredit_Numerator as string,",
				"          DualCredit_Denominator as string,",
				"          DualCredit_Rate as string,",
				"          DualCredit_Decile as string,",
				"          SQSS_Combined_Decile as string,",
				"          {2023_Score} as string,",
				"          {2023_Annual_Identification} as string,",
				"          {2022_Cycle_Support} as string,",
				"          {2023_Cycle_Support} as string,",
				"          WSIF_Year as string,",
				"          organizationid as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source3",
				"source3 select(mapColumn(",
				"          ESD_Organization_Id,",
				"          ESD_Name,",
				"          District_Organization_Id,",
				"          District_Code,",
				"          District_Name,",
				"          School_Code,",
				"          School_Name,",
				"          School_Organization_Id,",
				"          School_Type,",
				"          Title = {2023_TitleI},",
				"          Student_Group,",
				"          Proficiency_ELA_Numerator,",
				"          Proficiency_ELA_Denominator,",
				"          Proficiency_ELA_Rate,",
				"          Proficiency_ELA_Decile,",
				"          ELA_MetESSA_Participation,",
				"          Proficiency_Math_Numerator,",
				"          Proficiency_Math_Denominator,",
				"          Proficiency_Math_Rate,",
				"          Proficiency_Math_Decile,",
				"          Math_MetESSA_Participation,",
				"          Proficiency_Combined_Decile,",
				"          Growth_ELA_NumberofStudents,",
				"          Growth_ELA_Median_SGP,",
				"          Growth_ELA_Decile,",
				"          Growth_Math_NumberofStudents,",
				"          Growth_Math_Median_SGP,",
				"          Growth_Math_Decile,",
				"          Other_Academic_Combined_Decile,",
				"          Grad_FourYear_Numerator,",
				"          Grad_FourYear_Denominator,",
				"          Grad_FourYear_Rate,",
				"          Grad_FourYear_Decile,",
				"          Grad_Extended_TotalIncrease,",
				"          Grad_Extended_DecileIncrease,",
				"          Grad_Combined_Decile,",
				"          EL_Progress_Numerator,",
				"          EL_Progress_Denominator,",
				"          EL_Progress_Rate,",
				"          EL_Progress_Decile,",
				"          RegularAttendance_Numerator,",
				"          RegularAttendance_Denominator,",
				"          RegularAttendance_Rate,",
				"          RegularAttendance_Decile,",
				"          NinthGradeOnTrack_Numerator,",
				"          NinthGradeOnTrack_Denominator,",
				"          NinthGradeOnTrack_Rate,",
				"          NinthGradeOnTrack_Decile,",
				"          DualCredit_Numerator,",
				"          DualCredit_Denominator,",
				"          DualCredit_Rate,",
				"          DualCredit_Decile,",
				"          SQSS_Combined_Decile,",
				"          Final_School_Score = {2023_Score},",
				"          Cycle_Support = {2023_Cycle_Support},",
				"          WSIF_Year,",
				"          organizationid",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4",
				"select4 derive(AL_ELA_NumberofStudents = \"\",",
				"          AL_ELA_Avg_Level = \"\",",
				"          AL_ELA_Decile = \"\",",
				"          AL_Math_NumberofStudents = \"\",",
				"          AL_Math_Avg_Level = \"\",",
				"          AL_Math_Decile = \"\",",
				"          Support_Tier = \"\",",
				"          Growth_Combined_Decile = \"\") ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'synapseanalytics',",
				"     schemaName: 'staging',",
				"     tableName: 'ImprovementFramework',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     allowCopyCommand: true,",
				"     staged: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
			]
		}
	}
}