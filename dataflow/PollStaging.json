{
	"name": "PollStaging",
	"properties": {
		"folder": {
			"name": "Poll"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "StagingPoll",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "unpivot1"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          Question as string,",
				"          {Response Category} as string,",
				"          {Reponse Type} as string,",
				"          Total as double,",
				"          {2-3-2 PARTY ID / DEM} as double,",
				"          {2-3-2 PARTY ID / INDY } as double,",
				"          {2-3-2 PARTY ID / REP } as double,",
				"          {2-3-2 PARTY ID / LIB } as double,",
				"          {2-3-2 PARTY ID / MOD } as double,",
				"          {2-3-2 PARTY ID / CON } as double,",
				"          {2-3-2 PARTY ID X IDEOLOGY  / LIB DEM } as double,",
				"          {2-3-2 PARTY ID X IDEOLOGY  / MOD/CNS DEM } as double,",
				"          {2-3-2 PARTY ID X IDEOLOGY  / LB/MD INDY } as double,",
				"          {2-3-2 PARTY ID X IDEOLOGY  / CON INDY } as double,",
				"          {2-3-2 PARTY ID X IDEOLOGY  / MOD/LIB REP } as double,",
				"          {2-3-2 PARTY ID X IDEOLOGY  / CON REP } as double,",
				"          {GENDER X PARTY ID  / DEM MEN } as double,",
				"          {GENDER X PARTY ID  / DEM WOM } as double,",
				"          {GENDER X PARTY ID  / INDY MEN } as double,",
				"          {GENDER X PARTY ID / INDY WOM } as double,",
				"          {GENDER X PARTY ID / REP MEN } as double,",
				"          {GENDER X PARTY ID / REP WOM } as double,",
				"          {RACE x DEM / WHITE DEM } as double,",
				"          {RACE x DEM / DEM OF COLOR } as double,",
				"          {GENDER  / MALE } as double,",
				"          {GENDER  / FMLE } as double,",
				"          {AGE  / 18-34 } as double,",
				"          {AGE  / 35-49 } as double,",
				"          {AGE  / 50-64 } as double,",
				"          {AGE  / 65+ } as double,",
				"          {AGE 2-WAY  / 18-49 } as double,",
				"          {AGE 2-WAY  / 50+ } as double,",
				"          {RACE  / WHITE } as double,",
				"          {RACE  / AFAM } as double,",
				"          {RACE  / LATINO } as double,",
				"          {RACE  / AAPI } as double,",
				"          {RACE  / VTR OF COLOR } as double,",
				"          {REGION  / KING COUNTY } as double,",
				"          {REGION  / NRTH WEST } as double,",
				"          {REGION  / SOUTH WEST } as double,",
				"          {REGION  / EAST } as double,",
				"          {EDUC  / <BA } as double,",
				"          {EDUC  / BA+ } as double,",
				"          {GENDER X AGE  / <50 MEN } as double,",
				"          {GENDER X AGE  / <50 WOMEN } as double,",
				"          {GENDER X AGE  / 50+ MEN } as double,",
				"          {GENDER X AGE  / 50+ WOMEN } as double,",
				"          {PARENT  / ALL PARENT } as double,",
				"          {PARENT  / YES PUBLIC } as double,",
				"          {PARENT  / NOT PARENT } as double,",
				"          {RACE x PARENT  / WHITE PARENT } as double,",
				"          {RACE x PARENT  / PRNT OF COLOR } as double,",
				"          {HHI x PARENT  / <$50k PARENT } as double,",
				"          {HHI x PARENT  / $50k+ PARENT } as double,",
				"          {IMMIGRANT  / 1ST/2ND GEN } as double,",
				"          {IMMIGRANT  / 3RD+ GEN } as double,",
				"          {HOUSEHOLD INCOME  / <$50k } as double,",
				"          {HOUSEHOLD INCOME  / $50k- $100k } as double,",
				"          {HOUSEHOLD INCOME  / $100k+ } as double,",
				"          {COMMUNITY TYPE  / BIG CITY } as double,",
				"          {COMMUNITY TYPE  / SUB URBAN } as double,",
				"          {COMMUNITY TYPE  / SMALL TOWN } as double,",
				"          {COMMUNITY TYPE  / RURAL } as double,",
				"          {ED QUAL SAT  / V SAT } as double,",
				"          {ED QUAL SAT  / SAT TOTAL } as double,",
				"          {ED QUAL SAT  / DISSAT } as double,",
				"          {CHARTERS IN WA?  / THINKS YES } as double,",
				"          {CHARTERS IN WA?  / THINKS NO } as double,",
				"          {CHARTERS PUB OR PRIV  / PRIVATE } as double,",
				"          {CHARTERS PUB OR PRIV  / PUBLIC } as double,",
				"          {CHARTERS PUB OR PRIV  / UNSURE } as double,",
				"          {RECENT NEWS?  / YES } as double,",
				"          {RECENT NEWS?  / NO/NS } as double,",
				"          {IMPACT ON OPINION  / MORE } as double,",
				"          {IMPACT ON OPINION  / NO DIFF } as double,",
				"          {IMPACT ON OPINION  / LESS } as double,",
				"          {TEACHER UNIONS  / FAV } as double,",
				"          {TEACHER UNIONS  / VERY FAV } as double,",
				"          {TEACHER UNIONS  / SW FAV } as double,",
				"          {TEACHER UNIONS  / UNFAV } as double,",
				"          {TEACHERS  / FAV } as double,",
				"          {TEACHERS  / UNFAV } as double,",
				"          {LOC SCH DSTRCT  / FAV } as double,",
				"          {LOC SCH DSTRCT  / UNFAV } as double,",
				"          {LOCAL SCH BRD  / FAV } as double,",
				"          {LOCAL SCH BRD  / UNFAV } as double,",
				"          {LEG DEMS  / FAV } as double,",
				"          {LEG DEMS  / UNFAV } as double,",
				"          {LEG REPS  / FAV } as double,",
				"          {LEG REPS  / UNFAV } as double,",
				"          {CHARTERS QUALITY VS PUBLIC  / BETTER } as double,",
				"          {CHARTERS QUALITY VS PUBLIC  / SAME/ WORSE } as double,",
				"          {CHARTERS QUALITY VS PUBLIC  / NOT SURE } as double,",
				"          {INITIAL CHARTERS SUPPORT  / SUPP } as double,",
				"          {INITIAL CHARTERS SUPPORT  / OPP } as double,",
				"          {INITIAL CHARTERS SUPPORT  / UNSURE } as double,",
				"          {INITIAL CHARTERS SUPPORT  / STR SUPP } as double,",
				"          {INITIAL CHARTERS SUPPORT  / STR OPP } as double,",
				"          {INITIAL CHARTERS SUPPORT  / WEAK OPIN } as double,",
				"          {FINAL CHARTERS SUPPORT  / SUPP } as double,",
				"          {FINAL CHARTERS SUPPORT  / OPP } as double,",
				"          {FINAL CHARTERS SUPPORT  / UNSURE } as double,",
				"          {FINAL CHARTERS SUPPORT  / STR SUPP } as double,",
				"          {FINAL CHARTERS SUPPORT  / STR OPP } as double,",
				"          {FINAL CHARTERS SUPPORT  / WEAK OPIN } as double,",
				"          {ACCOUNTABILITY CHRTRS VS TRDTNL  / BOTH } as double,",
				"          {ACCOUNTABILITY CHRTRS VS TRDTNL  / CHRT NOT TRD } as double,",
				"          {ACCOUNTABILITY CHRTRS VS TRDTNL  / TRD NOT CHRT } as double,",
				"          {ACCOUNTABILITY CHRTRS VS TRDTNL  / NEITHER } as double,",
				"          {ACCOUNTABILITY INITIAL  / VERY CONC. } as double,",
				"          {ACCOUNTABILITY INITIAL  / TOTAL CONC. } as double,",
				"          {ACCOUNTABILITY INITIAL  / NOT CONC. } as double,",
				"          {ACCOUNTABILITY INITIAL  / NOT SURE } as double,",
				"          {ACCOUNTABILITY FINAL  / VERY CONC. } as double,",
				"          {ACCOUNTABILITY FINAL  / TOTAL CONC. } as double,",
				"          {ACCOUNTABILITY FINAL  / NOT CONC. } as double,",
				"          {ACCOUNTABILITY FINAL  / NOT SURE } as double,",
				"          {ACCOUNTABILITY SHIFT  / LESS CONC. } as double,",
				"          {ACCOUNTABILITY SHIFT  / MORE CONC. } as double,",
				"          {ACCOUNTABILITY SHIFT  / NO CHANGE } as double,",
				"          {INITIAL FUNDING EQUITY  / SUPP } as double,",
				"          {INITIAL FUNDING EQUITY  / OPP } as double,",
				"          {INITIAL FUNDING EQUITY  / UNSURE } as double,",
				"          {INITIAL FUNDING EQUITY  / WEAK } as double,",
				"          {POST MSG FUNDING EQUITY  / SUPP } as double,",
				"          {POST MSG FUNDING EQUITY  / OPP } as double,",
				"          {POST MSG FUNDING EQUITY  / UNSURE } as double,",
				"          {POST MSG FUNDING EQUITY  / WEAK } as double,",
				"          {FUND MSG MOVEMENT  / OPP/DK TO SUPP } as double,",
				"          {FUND MSG MOVEMENT  / SUPP TO OPP/DK } as double,",
				"          {FUND MSG MOVEMENT  / ALL POS MVMT } as double,",
				"          {INITIAL WINDOW  / SUPP } as double,",
				"          {INITIAL WINDOW  / OPP } as double,",
				"          {INITIAL WINDOW  / UNSURE } as double,",
				"          {INITIAL WINDOW  / WEAK } as double,",
				"          {POST MSG WINDOW  / SUPP } as double,",
				"          {POST MSG WINDOW  / OPP } as double,",
				"          {POST MSG WINDOW  / UNSURE } as double,",
				"          {POST MSG WINDOW  / WEAK } as double,",
				"          {WINDOW SWITCH  / TO SUPP } as double,",
				"          {WINDOW SWITCH  / TO OPP --} as double,",
				"          {WINDOW SWITCH  / ALL POS MVMT } as double,",
				"          {DEM x AGE  / 18-49 DEM } as double,",
				"          {DEM x AGE  / 50+ DEM } as double,",
				"          {DEM x EDU  / NO BA DEM } as double,",
				"          {DEM x EDU  / BA+ DEM } as double,",
				"          {DEM x COMM TYPE  / URBAN DEM } as double,",
				"          {DEM x COMM TYPE  / RURAL DEM } as double,",
				"          {DEM x INCOME  / <$75k DEM } as double,",
				"          {DEM x INCOME  / $75k+ DEM } as double,",
				"          {VOC X AGE  / 18-49 VOC } as double,",
				"          {VOC X AGE  / 50+ VOC } as double,",
				"          {VOC X GENDER  / VOC MEN } as double,",
				"          {VOC X GENDER  / VOC WOMEN } as double,",
				"          {VOC x EDU  / NO BA VOC } as double,",
				"          {VOC x EDU  / BA+ VOC } as double,",
				"          {VOC x COMM TYPE  / URBAN VOC } as double,",
				"          {VOC x COMM TYPE  / RURAL VOC } as double,",
				"          {VOC x INCOME  / <$75k VOC } as double,",
				"          {VOC x INCOME  / $75k+ VOC } as double,",
				"          {2020 VOTE  / BIDEN } as double,",
				"          {2021 VOTE  / TRUMP } as double,",
				"          {2022 VOTE  / OTHER/ DNV } as double,",
				"          {SUPPORT COHORT  / CORE BASE } as double,",
				"          {SUPPORT COHORT  / SOFT BASE } as double,",
				"          {SUPPORT COHORT  / WIN- ABLE } as double,",
				"          {SUPPORT COHORT  / VUL- NRBLE } as double,",
				"          {SUPPORT COHORT  / ANY SWING } as double,",
				"          {SUPPORT COHORT  / ANTI- CHARTR } as double,",
				"          {TARGETS  / OPIN LEADER } as double,",
				"          {TARGETS  / WHITE LIBS } as double,",
				"          {TARGETS  / URBAN DEMS } as double,",
				"          {TARGETS  / MOVE TO SUPP } as double,",
				"          {TARGETS  / SWING VOTER} as double",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 unpivot(output(",
				"          {Question Sub Category} as string,",
				"          Values as double",
				"     ),",
				"     ungroupBy(Question,",
				"          {Reponse Type},",
				"          {Response Category}),",
				"     lateral: true,",
				"     ignoreNullPivots: false) ~> unpivot1",
				"unpivot1 derive(Type = split({Question Sub Category}, '/')[1],",
				"          {Sub Type} = split({Question Sub Category}, '/')[2]) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'synapseanalytics',",
				"     schemaName: 'staging',",
				"     tableName: 'Poll',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     recreate: true,",
				"     allowCopyCommand: true,",
				"     staged: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
			]
		}
	}
}