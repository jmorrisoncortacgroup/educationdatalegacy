{
	"name": "F195Staging_old",
	"properties": {
		"folder": {
			"name": "F-195"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "stagingF2019",
						"type": "DatasetReference"
					},
					"name": "F19"
				},
				{
					"dataset": {
						"referenceName": "stagingF2020",
						"type": "DatasetReference"
					},
					"name": "F20"
				},
				{
					"dataset": {
						"referenceName": "stagingF2021",
						"type": "DatasetReference"
					},
					"name": "F21"
				},
				{
					"dataset": {
						"referenceName": "stagingF2022",
						"type": "DatasetReference"
					},
					"name": "F22"
				},
				{
					"dataset": {
						"referenceName": "stagingF2023",
						"type": "DatasetReference"
					},
					"name": "F23"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "select1"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "derivedColumn4"
				},
				{
					"name": "derivedColumn5"
				},
				{
					"name": "select2"
				},
				{
					"name": "select3"
				},
				{
					"name": "select4"
				},
				{
					"name": "select5"
				},
				{
					"name": "union1"
				},
				{
					"name": "union2"
				},
				{
					"name": "union3"
				},
				{
					"name": "union4"
				}
			],
			"scriptLines": [
				"source(output(",
				"          CCDDD as string,",
				"          Fund as string,",
				"          Item as string,",
				"          {2018-19 Bud} as string,",
				"          {2019-20 Proj} as string,",
				"          {2020-21 Proj} as string,",
				"          {2021-22 Proj} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> F19",
				"source(output(",
				"          CCDDD as string,",
				"          Fund as string,",
				"          Item as string,",
				"          {2019-2020 Current} as string,",
				"          {2020-2021 Forecast} as string,",
				"          {2021-2022 Forecast} as string,",
				"          {2022-2023 Forecast} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> F20",
				"source(output(",
				"          CCDDD as string,",
				"          Fund as string,",
				"          Item as string,",
				"          {2020-2021 Current} as string,",
				"          {2021-2022 Forecast} as string,",
				"          {2022-2023 Forecast} as string,",
				"          {2023-2024 Forecast} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> F21",
				"source(output(",
				"          CCDDD as string,",
				"          Fund as string,",
				"          Item as string,",
				"          {2021-2022 Forecast} as string,",
				"          {2022-2023 Forecast} as string,",
				"          {2023-2024 Forecast} as string,",
				"          {2024-2025 Forecast} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> F22",
				"source(output(",
				"          CCDDD as string,",
				"          FUND as string,",
				"          ITEM as string,",
				"          {22-23 CURRENT} as string,",
				"          {23-24 FORECAST} as string,",
				"          {24-25 FORECAST} as string,",
				"          {25-26 FORECAST} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> F23",
				"derivedColumn1 select(mapColumn(",
				"          CCDDD = {District Code},",
				"          Item,",
				"          {School Year},",
				"          {2018-19 Current} = {2018-19 Bud},",
				"          {2019-20 Forcast F19} = {2019-20 Proj},",
				"          {2020-21 Forcast F19} = {2020-21 Proj},",
				"          {2021-22 Forcast F19} = {2021-22 Proj}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"F19 derive({District Code} = case(length(CCDDD) <5, '0' + CCDDD, CCDDD),",
				"          {School Year} = '2018-19') ~> derivedColumn1",
				"F20 derive({District Code} = case(length(CCDDD) <5, '0' + CCDDD, CCDDD),",
				"          {School Year} = '2019-20') ~> derivedColumn2",
				"F21 derive({District Code} = case(length(CCDDD) <5, '0' + CCDDD, CCDDD),",
				"          {School Year} = '2020-21') ~> derivedColumn3",
				"F22 derive({District Code} = case(length(CCDDD) <5, '0' + CCDDD, CCDDD),",
				"          {School Year} = '2021-22') ~> derivedColumn4",
				"F23 derive({District Code} = case(length(CCDDD) <5, '0' + CCDDD, CCDDD),",
				"          {School Year} = '2022-23') ~> derivedColumn5",
				"derivedColumn2 select(mapColumn(",
				"          CCDDD = {District Code},",
				"          Item,",
				"          {School Year},",
				"          {2019-2020 Current},",
				"          {2020-2021 Forecast F20} = {2020-2021 Forecast},",
				"          {2021-2022 Forecast F20} = {2021-2022 Forecast},",
				"          {2022-2023 Forecast F20} = {2022-2023 Forecast}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"derivedColumn3 select(mapColumn(",
				"          CCDDD = {District Code},",
				"          Item,",
				"          {School Year},",
				"          {2020-2021 Current},",
				"          {2021-2022 Forecast F21} = {2021-2022 Forecast},",
				"          {2022-2023 Forecast F21} = {2022-2023 Forecast},",
				"          {2023-2024 Forecast F21} = {2023-2024 Forecast}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3",
				"derivedColumn4 select(mapColumn(",
				"          CCDDD = {District Code},",
				"          Item,",
				"          {School Year},",
				"          {2021-2022 Current} = {2021-2022 Forecast},",
				"          {2022-2023 Forecast F22} = {2022-2023 Forecast},",
				"          {2023-2024 Forecast F22} = {2023-2024 Forecast},",
				"          {2024-2025 Forecast F22} = {2024-2025 Forecast}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4",
				"derivedColumn5 select(mapColumn(",
				"          CCDDD = {District Code},",
				"          Item = ITEM,",
				"          {School Year},",
				"          {22-23 Current} = {22-23 CURRENT},",
				"          {23-24 Forecast F23} = {23-24 FORECAST},",
				"          {24-25 Forecast F23} = {24-25 FORECAST},",
				"          {25-26 Forecast F23} = {25-26 FORECAST}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select5",
				"select1, select2 union(byName: true)~> union1",
				"union1, select3 union(byName: true)~> union2",
				"union2, select4 union(byName: true)~> union3",
				"union3, select5 union(byName: true)~> union4",
				"union4 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'synapseanalytics',",
				"     schemaName: 'staging',",
				"     tableName: 'F195',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     allowCopyCommand: true,",
				"     staged: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     partitionBy('hash', 1),",
				"     preCommands: [],",
				"     postCommands: []) ~> sink1"
			]
		}
	}
}