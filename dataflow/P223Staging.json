{
	"name": "P223Staging",
	"properties": {
		"folder": {
			"name": "P-223"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "StagingP223SpecialEducation2023",
						"type": "DatasetReference"
					},
					"name": "P223SpecialEducation"
				},
				{
					"dataset": {
						"referenceName": "StagingP223HeadCount2023",
						"type": "DatasetReference"
					},
					"name": "P223HeadCount"
				},
				{
					"dataset": {
						"referenceName": "StagingP223TBIP2023",
						"type": "DatasetReference"
					},
					"name": "P223TBIP"
				},
				{
					"dataset": {
						"referenceName": "StagingP223SpecialEducation2024",
						"type": "DatasetReference"
					},
					"name": "P223SpecialEducation2024"
				},
				{
					"dataset": {
						"referenceName": "StagingHeadCount2024",
						"type": "DatasetReference"
					},
					"name": "P223HeadCount2024"
				},
				{
					"dataset": {
						"referenceName": "StagingP223TBIP2024",
						"type": "DatasetReference"
					},
					"name": "P223TBIP2024"
				},
				{
					"dataset": {
						"referenceName": "StagingP223SpecialEducation2025",
						"type": "DatasetReference"
					},
					"name": "P223SpecialEducation2025"
				},
				{
					"dataset": {
						"referenceName": "StagingP223TBIP2025",
						"type": "DatasetReference"
					},
					"name": "P223TBIP2025"
				},
				{
					"dataset": {
						"referenceName": "StagingHeadCount2025",
						"type": "DatasetReference"
					},
					"name": "P223HeadCount2025"
				},
				{
					"dataset": {
						"referenceName": "StagingHeadCount2026",
						"type": "DatasetReference"
					},
					"name": "P223HeadCount2026"
				},
				{
					"dataset": {
						"referenceName": "StagingP223TBIP2026",
						"type": "DatasetReference"
					},
					"name": "P223TBIP2026"
				},
				{
					"dataset": {
						"referenceName": "StagingP223SpecialEducation2026",
						"type": "DatasetReference"
					},
					"name": "P223SpecialEducation2026"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink1"
				},
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink2"
				},
				{
					"linkedService": {
						"referenceName": "AzureSynapseAnalytics1",
						"type": "LinkedServiceReference"
					},
					"name": "sink3"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				},
				{
					"name": "select2"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "select3"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "derivedSpEd2024"
				},
				{
					"name": "derivedHeadCount2024"
				},
				{
					"name": "derivedTBIP2024"
				},
				{
					"name": "union1"
				},
				{
					"name": "union2"
				},
				{
					"name": "union3"
				},
				{
					"name": "selectSpEd2024"
				},
				{
					"name": "derivedSpEd2025"
				},
				{
					"name": "derivedTBIP2025"
				},
				{
					"name": "derivedHeadCount2025"
				},
				{
					"name": "union4"
				},
				{
					"name": "union5"
				},
				{
					"name": "union6"
				},
				{
					"name": "derivedHeadCount2026"
				},
				{
					"name": "derivedTBIP2026"
				},
				{
					"name": "derivedSpEd2026"
				},
				{
					"name": "union7"
				},
				{
					"name": "select4"
				},
				{
					"name": "union8"
				},
				{
					"name": "union9"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223SpecialEducation",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223HeadCount",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223TBIP",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223SpecialEducation2024",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223HeadCount2024",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223TBIP2024",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223SpecialEducation2025",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223TBIP2025",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223HeadCount2025",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223HeadCount2026",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223TBIP2026",
				"source(output(",
				"          {School Name} as string,",
				"          Column1 as string,",
				"          SEPTEMBER as integer,",
				"          OCTOBER as integer,",
				"          NOVEMBER as integer,",
				"          DECEMBER as integer,",
				"          JANUARY as integer,",
				"          FEBRUARY as integer,",
				"          MARCH as integer,",
				"          APRIL as integer,",
				"          MAY as integer,",
				"          JUNE as integer,",
				"          AVERAGE as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> P223SpecialEducation2026",
				"P223SpecialEducation derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',    \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',    \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District', \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1735','State Total',\r",
				"    \"\" \r",
				"),",
				"          Year = '2022-23') ~> derivedColumn1",
				"union9 select(mapColumn(",
				"          Year,",
				"          {School Name},",
				"          SchoolName,",
				"          Grades = Column1,",
				"          SEPTEMBER,",
				"          OCTOBER,",
				"          NOVEMBER,",
				"          DECEMBER,",
				"          JANUARY,",
				"          FEBRUARY,",
				"          MARCH,",
				"          APRIL,",
				"          MAY,",
				"          JUNE,",
				"          AVERAGE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"P223HeadCount derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',   \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',       \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',    \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2022-23') ~> derivedColumn2",
				"union8 select(mapColumn(",
				"          {School Name},",
				"          Grades = Column1,",
				"          SEPTEMBER,",
				"          OCTOBER,",
				"          NOVEMBER,",
				"          DECEMBER,",
				"          JANUARY,",
				"          FEBRUARY,",
				"          MARCH,",
				"          APRIL,",
				"          MAY,",
				"          JUNE,",
				"          AVERAGE,",
				"          SchoolName,",
				"          Year",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3",
				"P223TBIP derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',\r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',          \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',    \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2022-23') ~> derivedColumn3",
				"selectSpEd2024 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',    \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',      \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District', \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1735','State Total',    \"\" ),",
				"          Year = '2023-24') ~> derivedSpEd2024",
				"P223HeadCount2024 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',  \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',       \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',      \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District', \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2023-24') ~> derivedHeadCount2024",
				"P223TBIP2024 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',    \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',      \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District', \r",
				"like({School Name}, 'Renton%'),'Renton School District',\r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District',  \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2023-24') ~> derivedTBIP2024",
				"derivedColumn1, derivedSpEd2024 union(byName: true)~> union1",
				"derivedColumn2, derivedHeadCount2024 union(byName: true)~> union2",
				"derivedColumn3, derivedTBIP2024 union(byName: true)~> union3",
				"P223SpecialEducation2024 select(mapColumn(",
				"          {School Name},",
				"          Column1,",
				"          SEPTEMBER,",
				"          OCTOBER,",
				"          NOVEMBER,",
				"          DECEMBER,",
				"          JANUARY,",
				"          FEBRUARY,",
				"          MARCH,",
				"          APRIL,",
				"          MAY,",
				"          JUNE,",
				"          AVERAGE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectSpEd2024",
				"P223SpecialEducation2025 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',    \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',    \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District', \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1735','State Total',\r",
				"    \"\" \r",
				"),",
				"          Year = '2024-25') ~> derivedSpEd2025",
				"P223TBIP2025 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',\r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',          \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',    \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2024-25') ~> derivedTBIP2025",
				"P223HeadCount2025 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',   \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',       \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',      \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2024-25') ~> derivedHeadCount2025",
				"union1, derivedSpEd2025 union(byName: true)~> union4",
				"union2, derivedHeadCount2025 union(byName: true)~> union5",
				"union3, derivedTBIP2025 union(byName: true)~> union6",
				"P223HeadCount2026 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',     \r",
				"like({School Name}, '%Inno%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',   \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',       \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',      \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2025-26') ~> derivedHeadCount2026",
				"P223TBIP2026 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',    \r",
				"like({School Name}, '%Inno%'),'Innovation High School',    \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',   \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',       \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',      \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1251','State Total',     \"\"  ),",
				"          Year = '2025-26') ~> derivedTBIP2026",
				"P223SpecialEducation2026 derive(SchoolName = case(     \r",
				"like({School Name}, '%Catalyst%'),'Catalyst: Bremerton',      \r",
				"like({School Name}, '%Whatcom%'),'Whatcom Intergenerational High School',      \r",
				"like({School Name}, '%Rainier Prep%'),'Rainier Prep',     \r",
				"like({School Name}, '%Why Not %'),'Why Not You Academy',     \r",
				"like({School Name}, '%Spokane I%'),'Spokane International Academy',     \r",
				"like({School Name}, '%Pullman C%'),'Pullman Community Montessori',     \r",
				"like({School Name}, '%Salish Sea%'),'Impact: Salish Sea Elementary',     \r",
				"like({School Name}, '%Rainier Valley%'),'Rainier Valley Leadership Academy',     \r",
				"like({School Name}, '%Atlas%'),'Summit Atlas',     \r",
				"like({School Name}, '%Sierra%'),'Summit Sierra',     \r",
				"like({School Name}, '%Lumen%'),'Lumen High School',     \r",
				"like({School Name}, '%PRIDE%'),'Innovation High School',\r",
				"like({School Name}, '%Inno%'),'Innovation High School',     \r",
				"like({School Name}, '% Commencement Bay%'),'Impact: Commencement Bay Elementary',     \r",
				"like({School Name}, '%Olympus%'),'Summit Olympus',     \r",
				"like({School Name}, '%Impact Publ%'),'Impact: Puget Sound Elementary', \r",
				"like({School Name}, '%Pinnacles%'),'Pinnacles Prep',   \r",
				"like({School Name}, '%Black%'),'Impact: Black River Elementary',  \r",
				"like({School Name}, '%Rooted%'),'Rooted School Vancouver',       \r",
				"like({School Name}, 'Belling%'),'Bellingham School District',  \r",
				"like({School Name}, 'Bremerton%'),'Bremerton School District',  \r",
				"like({School Name}, 'Highline%'),'Highline School District',   \r",
				"like({School Name}, 'Mead%'),'Mead School District',   \r",
				"like({School Name}, 'Pullman School%'),'Pullman School District', \r",
				"like({School Name}, 'Seattle%'),'Seattle Public Schools',  \r",
				"like({School Name}, 'Spokane School%'),'Spokane School District',  \r",
				"like({School Name}, 'Tacoma School%'),'Tacoma School District',  \r",
				"like({School Name}, 'Tukwila School%'),'Tukwila School District',  \r",
				"like({School Name}, 'Wenatchee School%'),'Wenatchee School District',      \r",
				"like({School Name}, 'Renton%'),'Renton School District', \r",
				"like({School Name}, 'Vancouver School%'),'Vancouver School District', \r",
				"left({School Name}, 4) == '1735','State Total',     \"\"  ),",
				"          Year = '2025-26') ~> derivedSpEd2026",
				"union6, derivedTBIP2026 union(byName: true)~> union7",
				"union7 select(mapColumn(",
				"          {School Name},",
				"          Grades = Column1,",
				"          SEPTEMBER,",
				"          OCTOBER,",
				"          NOVEMBER,",
				"          DECEMBER,",
				"          JANUARY,",
				"          FEBRUARY,",
				"          MARCH,",
				"          APRIL,",
				"          MAY,",
				"          JUNE,",
				"          AVERAGE,",
				"          SchoolName,",
				"          Year",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4",
				"union5, derivedHeadCount2026 union(byName: true)~> union8",
				"union4, derivedSpEd2026 union(byName: true)~> union9",
				"select2 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'synapseanalytics',",
				"     schemaName: 'staging',",
				"     tableName: 'P223SpecialEducation',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     truncate: true,",
				"     allowCopyCommand: true,",
				"     staged: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink1",
				"select3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'synapseanalytics',",
				"     schemaName: 'staging',",
				"     tableName: 'P223HeadCount',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     truncate: true,",
				"     allowCopyCommand: true,",
				"     staged: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink2",
				"select4 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'table',",
				"     store: 'synapseanalytics',",
				"     schemaName: 'staging',",
				"     tableName: 'P223TBIP',",
				"     insertable: true,",
				"     updateable: false,",
				"     deletable: false,",
				"     upsertable: false,",
				"     truncate: true,",
				"     allowCopyCommand: true,",
				"     staged: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink3"
			]
		}
	}
}